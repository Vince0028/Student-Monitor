{% extends 'base.html' %}

{% block title %}My Profile - Student Monitor{% endblock %}

{% block content %}
<div class="form-page-container">
    <div class="card p-8 md:p-10 shadow-lg rounded-xl max-w-2xl mx-auto"> {# Added card styling #}
        <h2 class="text-3xl font-extrabold text-gray-800 mb-6 text-center">
            <i class="fas fa-user-circle text-indigo-600 mr-3"></i> Edit Your Profile
        </h2>
        <p class="text-gray-600 mb-8 text-center">Update your personal information and security settings.</p>

        <form method="POST" class="space-y-6"> {# Increased spacing between form groups #}
            <div class="input-group">
                <label for="current_username" class="input-label flex items-center mb-2">
                    <i class="fas fa-id-badge text-gray-500 mr-2"></i> Current Username:
                </label>
                <input type="text" id="current_username" value="{{ user.username }}" disabled
                       class="form-input bg-gray-100 border border-gray-300 text-gray-600 cursor-not-allowed">
                <small class="form-hint text-gray-500 mt-1">Your current username. This field cannot be changed directly.</small>
            </div>

            <div class="input-group">
                <label for="new_username" class="input-label flex items-center mb-2">
                    <i class="fas fa-user-edit text-indigo-500 mr-2"></i> New Username (optional):
                </label>
                <input type="text" id="new_username" name="new_username"
                       placeholder="Leave blank to keep current username"
                       class="form-input focus:ring-indigo-500 focus:border-indigo-500">
                <small class="form-hint text-gray-500 mt-1">Enter a new username if you wish to change it.</small>
            </div>
            
            <div class="border-t border-gray-200 pt-6 mt-6"> {# Separator for password section #}
                <h3 class="text-xl font-semibold text-gray-700 mb-4 flex items-center">
                    <i class="fas fa-key text-red-500 mr-2"></i> Change Password
                </h3>
                <div class="input-group">
                    <label for="new_password" class="input-label flex items-center mb-2">
                        <i class="fas fa-lock text-red-500 mr-2"></i> New Password (optional):
                    </label>
                    <input type="password" id="new_password" name="new_password"
                           placeholder="Leave blank to keep current password"
                           class="form-input focus:ring-red-500 focus:border-red-500">
                    <small class="form-hint text-gray-500 mt-1">Enter a new password if you wish to change it (minimum 6 characters).</small>
                </div>
                <div class="input-group">
                    <label for="confirm_new_password" class="input-label flex items-center mb-2">
                        <i class="fas fa-check-circle text-red-500 mr-2"></i> Confirm New Password:
                    </label>
                    <input type="password" id="confirm_new_password" name="confirm_new_password"
                           placeholder="Re-enter new password"
                           class="form-input focus:ring-red-500 focus:border-red-500">
                    <small class="form-hint text-gray-500 mt-1">Re-enter your new password for confirmation.</small>
                </div>
            </div>

            <div class="input-group mt-6">
                <label for="current_password" class="input-label flex items-center mb-2 font-bold text-gray-700">
                    <i class="fas fa-shield-alt text-yellow-600 mr-2"></i> Current Password (REQUIRED to save changes):
                </label>
                <input type="password" id="current_password" name="current_password" required
                       placeholder="Enter your current password to confirm changes"
                       class="form-input border-red-400 focus:border-red-600 focus:ring-red-600">
                <small class="form-hint text-red-600 mt-1">You must enter your current password to save any changes.</small>
            </div>

            <div class="flex flex-col sm:flex-row justify-end space-y-4 sm:space-y-0 sm:space-x-4 mt-8">
                <a href="{% if session.user_type == 'student' %}{{ url_for('student_dashboard') }}{% elif session.user_type == 'teacher' %}{{ url_for('teacher_dashboard') }}{% else %}{{ url_for('index') }}{% endif %}"
                   class="btn btn-secondary text-center">
                   <i class="fas fa-times-circle mr-2"></i> Cancel
                </a>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save mr-2"></i> Save Profile
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
