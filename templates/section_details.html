{% extends 'base.html' %}

{% block title %}{{ section.name }} Periods - Student Monitor{% endblock %}

{% block content %}
<div class="dashboard-container">
    <h2>{{ section.name }} {% if section.strand %}({{ section.strand.name }} Strand){% endif %} ({{ section.grade_level.name }})</h2>
    <p class="dashboard-welcome">Manage academic {{ period_type | lower }}s and student enrollments within this section.</p>

    <div class="dashboard-grid">
        <div class="card dashboard-option-card full-width">
            <h3>Section {{ period_type }}s</h3>
            <p>Add a new academic {{ period_type | lower }} (e.g., {{ period_names[0] }}) for this section.</p>
            <a href="{{ url_for('add_section_period', section_id=section.id) }}" class="btn btn-primary btn-icon"><i class="fas fa-calendar-plus"></i> Add New {{ period_type }}</a>
        </div>
    </div>

    {% if section_periods %}
    <div class="card mt-40">
        <h3>Existing {{ period_type }}s</h3>
        <div class="list-container">
            {% for per in section_periods %}
            <div class="list-item">
                <span>{{ per.period_name }} ({{ per.school_year }}) - Assigned Teacher: {{ per.assigned_teacher.username }}</span>
                <div class="button-group">
                    <a href="{{ url_for('section_period_details', section_period_id=per.id) }}" class="btn btn-view btn-icon-small">
                        <i class="fas fa-users"></i> View Students
                    </a>
                    <button type="button" class="btn btn-danger btn-icon-small delete-btn"
                            data-delete-url="{{ url_for('delete_section_period', section_period_id=per.id) }}"
                            data-redirect-url="{{ url_for('section_details', section_id=section.id) }}"
                            data-confirmation-message="Are you sure you want to delete {{ per.period_name }} for {{ per.school_year }}? This will also delete ALL associated students, subjects, attendance, and grades!"
                            data-item-name="{{ per.period_name }} ({{ per.school_year }})"
                            title="Delete {{ period_type }}">
                        <i class="fas fa-trash-alt"></i> Delete
                    </button>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% else %}
    <p class="no-data-message">No {{ period_type | lower }}s added to {{ section.name }} yet. Start by adding a new one!</p>
    {% endif %}

    <div class="button-group-right mt-40">
        <a href="{{ url_for('grade_level_details', grade_level_id=section.grade_level.id) }}" class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Back to Grade Level</a>
    </div>
</div>
{% endblock %}
