{% extends 'base.html' %}
{% block title %}Check Essay Answers{% endblock %}
{% block content %}
<div class="container" style="max-width:700px; margin:2rem auto;">
    <h2>Essay Scoring: {{ quiz.title }}</h2>
    <p class="text-muted">Student: <strong>{{ student.name }}</strong></p>
    <form method="POST">
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Question</th>
                    <th>Student Answer</th>
                    <th>Score</th>
                </tr>
            </thead>
            <tbody>
                {% for q in essay_questions %}
                <tr>
                    <td style="width:40%;">{{ q.text }}</td>
                    <td style="width:40%;">{{ essay_answers[q.id|string].answer_text if essay_answers[q.id|string] else '' }}</td>
                    <td style="width:20%;">
                        <input type="number" name="score_{{ q.id }}" min="0" max="{{ q.points or 1 }}" step="0.01"
                               value="{{ (essay_answers[q.id|string].score|int if essay_answers[q.id|string] and essay_answers[q.id|string].score is not none and essay_answers[q.id|string].score == essay_answers[q.id|string].score|int else essay_answers[q.id|string].score) if essay_answers[q.id|string] and essay_answers[q.id|string].score is not none else '' }}"
                               class="form-control" style="width:90px; display:inline;">
                        <span style="color:#6b7280; font-size:0.95rem;">/ {{ q.points or 1 }}</span>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <div class="d-flex justify-content-between mt-4">
            <a href="{{ url_for('manage_student_quiz', section_period_id=section_period_id, subject_id=subject_id, student_id=student.id) }}" class="btn btn-secondary">Back</a>
            <button type="submit" class="btn btn-success">Save Scores</button>
        </div>
    </form>
</div>
{% endblock %}
